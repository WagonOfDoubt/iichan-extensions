"use strict";!function(){var n="iichan-hide-thread-btn",e="iichan-hidden-thread-placeholder",t=window.location.href.match(/(?:\w+\.\w+\/)(.*)(?=\/)/)[1],i=function(){var n=JSON.parse(window.localStorage.getItem("iichan_hidden_threads")||"{}");return Array.isArray(n)?{}:n},a=function(n,e){var a=i();if(a[t]||(a[t]=[]),e)a[t].includes(n)||a[t].push(n);else{var c=a[t].indexOf(n);if(-1===c)return;a[t].splice(c,1)}!function(n){window.localStorage.setItem("iichan_hidden_threads",JSON.stringify(n))}(a)},c=function(e){if(e){var t=e.querySelector(":scope > .reflink");if(t)t.insertAdjacentHTML("afterend",'\n    <div class="'.concat(n,'" title="').concat("Скрыть тред",'" data-thread-id="').concat(e.id,'">\n      <svg>\n        <use class="iichan-icon-hide-use" xlink:href="#iichan-icon-hide" width="16" height="16" viewBox="0 0 16 16"/>\n        <use class="iichan-icon-unhide-use" xlink:href="#iichan-icon-unhide" width="16" height="16" viewBox="0 0 16 16"/>\n      </svg>\n    </div>\n  ')),e.querySelector(".".concat(n)).addEventListener("click",l)}},r=function(e){if(e){var t=e.querySelector(".catthread");t.insertAdjacentHTML("beforeend",'\n    <div class="'.concat(n,'" title="').concat("Скрыть тред",'" data-thread-id="').concat(e.id,'">\n      <svg>\n        <use class="iichan-icon-hide-use" xlink:href="#iichan-icon-hide" width="16" height="16" viewBox="0 0 16 16"/>\n        <use class="iichan-icon-unhide-use" xlink:href="#iichan-icon-unhide" width="16" height="16" viewBox="0 0 16 16"/>\n      </svg>\n    </div>\n  '));var i=t.querySelector(".".concat(n));i.classList.add("reply"),i.addEventListener("click",h)}},d=function(n){var e=!!document.querySelector(".catthreadlist"),a=e?".catthreadlist a":"[id^=thread]",d=n&&n.id.startsWith("thread-")?[n]:(n||document).querySelectorAll(a),o=e?r:c,h=i(),s=!0,u=!1,v=void 0;try{for(var f,p=d[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var y=f.value;y.id=e?"thread-"+y.title.match(/^#(\d+)\s/)[1]:y.id,o(y),h[t]&&(h[t].includes(y.id)&&l(y.id))}}catch(n){u=!0,v=n}finally{try{s||null==p.return||p.return()}finally{if(u)throw v}}},o=function(e){for(var t=e.target?e.target:null;t&&!t.classList.contains(n);)t=t.parentElement;var i=t?t.dataset.threadId:e;a(i,!1);var c=document.getElementById(i);if(c){c.classList.remove("iichan-thread-hidden");var r=document.getElementById("iichan-hidden-"+i);r&&r.parentElement.removeChild(r),e.preventDefault&&e.preventDefault()}},l=function(t){for(var i=t.target?t.target:null;i&&!i.classList.contains(n);)i=i.parentElement;var c=i?i.dataset.threadId:t;a(c,!0);var r=document.getElementById(c);r&&r.parentNode&&(r.classList.add("iichan-thread-hidden"),!!document.querySelector(".catthreadlist")||function(n){if(n){var t=n.id.split("-").pop(),i=n.querySelector(".filetitle").innerText||n.querySelector("blockquote").innerText;i=i.substr(0,50);var a="iichan-hidden-"+n.id;n.insertAdjacentHTML("beforebegin",'\n    <div class="reply '.concat(e,'" id="').concat(a,'">Тред <a title="').concat("Раскрыть тред",'">№').concat(t,"</a> скрыт (").concat(i||"изображение",")</div>\n  "));var c=n.previousElementSibling.querySelector(":scope > a");c.dataset.threadId=n.id,c.addEventListener("click",o)}}(r),t.preventDefault&&t.preventDefault())},h=function(e){for(var t=e.target?e.target:null;t&&!t.classList.contains(n);)t=t.parentElement;var i=t?t.dataset.threadId:e,c=i.split("-").pop(),r=document.getElementById("thread-"+c);a(i,r.classList.toggle("iichan-thread-hidden")),e.preventDefault&&e.preventDefault()},s=function(){var t;document.querySelector("#de-main")||(document.querySelector("body.replypage")||(document.head.insertAdjacentHTML("beforeend",'<style type="text/css">\n      .'.concat(e," {\n        pointer-events: none;\n      }\n      \n      .").concat(e," a {\n        cursor: pointer;\n        pointer-events: auto;\n      }\n      \n      .").concat(e,":hover + div,\n      .").concat(e,":hover + div + br {\n        display: block !important;\n      }\n      \n      .").concat(e," + div {\n        display: none;\n      }\n      .").concat(e," + div +  br {\n        display: none;\n      }\n      \n      .").concat(n," {\n        margin-left: 0.2em;\n        cursor: pointer;\n        display: inline-block;\n        width: 16px;\n        height: 16px;\n        vertical-align: text-top;\n      }\n      \n      .").concat(n," use {\n        pointer-events: none;\n      }\n      \n      .").concat(n," > svg {\n        width: 16px;\n        height: 16px;\n      }\n      \n      [id^=thread]:not(.iichan-thread-hidden) .").concat(n," .iichan-icon-unhide-use {\n        display: none;\n      }\n      \n      [id^=thread].iichan-thread-hidden .").concat(n," .iichan-icon-hide-use {\n        display: none;\n      }\n      \n      .catthreadlist a {\n        position: relative;\n        transition: opacity .3s ease-in-out, filter .3s ease-in-out;\n      }\n      \n      .catthreadlist .").concat("iichan-thread-hidden"," {\n        opacity: .6;\n      }\n      \n      .catthreadlist .").concat("iichan-thread-hidden",":not(:hover) {\n        opacity: .1;\n        filter: grayscale(100%);\n      }\n      \n      .catthread:hover .").concat(n," {\n        display: block;\n      }\n      \n      .catthread .").concat(n," {\n        text-decoration: none;\n        position: absolute;\n        top: 0;\n        right: 0;\n        display: none;\n        padding: 6px;\n      }\n      \n    </style>")),t='<div id="iichan-hide-threads-icons">\n    '.concat('\n    <svg xmlns="http://www.w3.org/2000/svg">\n      <symbol id="iichan-icon-hide" width="16" height="16" viewBox="0 0 16 16">\n        <path\n          fill="currentcolor"\n          d="m 2.8925753,6.0097655 c -1.039639,0 -1.876953,0.837315 -1.876953,1.876954 v 0.226562 c 0,1.039639 0.837314,1.876953 1.876953,1.876953 10.8787687,0 0.063512,0 10.2148497,0 1.039637,0 1.876953,-0.837314 1.876953,-1.876953 v -0.226562 c 0,-1.039639 -0.837315,-1.876954 -1.876953,-1.876954 -10.8494379,0 -0.248141,0 -10.2148497,0 z"/>\n      </symbol>\n      <symbol id="iichan-icon-unhide" width="16" height="16" viewBox="0 0 16 16">\n        <path\n          fill="currentcolor"\n          d="m 7.9589815,1.003906 c -1.106736,0 -1.996094,0.89131 -1.996094,1.998047 v 2.982421 h -3.070312 c -1.039639,0 -1.876953,0.837315 -1.876953,1.876954 V 8.08789 c 0,1.039639 0.837314,1.876953 1.876953,1.876953 h 3.070312 v 3.033204 c 0,1.106736 0.889358,1.998047 1.996094,1.998047 h 0.01563 c 1.106736,0 1.996094,-0.891311 1.996094,-1.998047 V 9.964843 h 3.1367195 c 1.039637,0 1.876953,-0.837314 1.876953,-1.876953 V 7.861328 c 0,-1.039639 -0.837315,-1.876954 -1.876953,-1.876954 H 9.9707005 V 3.001953 c 0,-1.106737 -0.889358,-1.998047 -1.996094,-1.998047 z"/>\n      </symbol>\n    </svg>\n  ',"\n  </div>"),document.body.insertAdjacentHTML("beforeend",t),d(),"MutationObserver"in window&&new MutationObserver(function(n){n.forEach(function(n){var e=!0,t=!1,i=void 0;try{for(var a,c=n.addedNodes[Symbol.iterator]();!(e=(a=c.next()).done);e=!0){var r=a.value;if(!r.querySelectorAll)return;d(r)}}catch(n){t=!0,i=n}finally{try{e||null==c.return||c.return()}finally{if(t)throw i}}})}).observe(document.body,{childList:!0,subtree:!0})))};document.body?s():document.addEventListener("DOMContentLoaded",s)}();