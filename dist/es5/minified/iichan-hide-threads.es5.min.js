!function(){"use strict";var e=50,t="iichan_hidden_threads",n="iichan-hide-thread-btn",r="Скрыть тред",a="iichan-thread-hidden",i="iichan-hidden-thread-placeholder",d=window.location.href.match(/(?:\w+\.\w+\/)(.*)(?=\/)/)[1],o=function(){var e=JSON.parse(window.localStorage.getItem(t)||"{}");return Array.isArray(e)?{}:e},c=function(e){window.localStorage.setItem(t,JSON.stringify(e))},l=function(e,t){var n=o();if(n[d]||(n[d]=[]),t)n[d].includes(e)||n[d].push(e);else{var r=n[d].indexOf(e);if(r===-1)return;n[d].splice(r,1)}c(n)},s=function(e){if(e){var t=e.querySelector(":scope > label");if(t){var a=document.createElement("span");a.title=r,a.classList.add(n),a.dataset.threadId=e.id,a.addEventListener("click",y),e.insertBefore(a,t.nextSibling)}}},u=function(e){if(e){var t=document.createElement("div");t.title="Скрыть тред",t.classList.add(n,"reply"),t.dataset.threadId=e.id,t.addEventListener("click",p),e.querySelector(".catthread").appendChild(t)}},h=function(t){if(t){var n=t.id.split("-").pop(),r=t.querySelector(".filetitle").innerText||t.querySelector("blockquote").innerText;r=r.substr(0,e);var a="iichan-hidden-"+t.id;t.insertAdjacentHTML("beforebegin",'\n      <div class="reply '+i+'" id="'+a+'">Тред <a>№'+n+"</a> скрыт ("+(r||"изображение")+")</div>\n    ");var d=t.previousElementSibling.querySelector(":scope > a");d.dataset.threadId=t.id,d.addEventListener("click",f)}},v=function(e){var t=!!document.querySelector(".catthreadlist"),n=t?".catthreadlist a":"[id^=thread]",r=e&&e.id.startsWith("thread-")?[e]:(e||document).querySelectorAll(n),a=t?u:s,i=o(),c=!0,l=!1,h=void 0;try{for(var v,f=r[Symbol.iterator]();!(c=(v=f.next()).done);c=!0){var p=v.value;p.id=t?"thread-"+p.title.match(/^#(\d+)\s/)[1]:p.id,a(p),i[d]&&i[d].includes(p.id)&&y(p.id)}}catch(e){l=!0,h=e}finally{try{!c&&f.return&&f.return()}finally{if(l)throw h}}},f=function(e){var t=e.target?e.target.dataset.threadId:e;l(t,!1);var n=document.getElementById(t);if(n){n.classList.remove(a);var r=document.getElementById("iichan-hidden-"+t);r&&r.parentElement.removeChild(r)}},y=function(e){var t=e.target?e.target.dataset.threadId:e;l(t,!0);var n=document.getElementById(t);if(n&&n.parentNode){n.classList.add(a);var r=!!document.querySelector(".catthreadlist");r||h(n)}},p=function(e){var t=e.target?e.target.dataset.threadId:e,n=t.split("-").pop(),r=document.getElementById("thread-"+n);l(t,r.classList.toggle(a)),e.preventDefault&&e.preventDefault()},m=function(){document.head.insertAdjacentHTML("beforeend",'<style type="text/css">\n        .'+i+" {\n            pointer-events: none;\n        }\n        \n        ."+i+" a {\n            cursor: pointer;\n            pointer-events: auto;\n        }\n        \n        ."+i+":hover + div,\n        ."+i+":hover + div + br {\n            display: block !important;\n        }\n        \n        ."+i+" + div {\n            display: none;\n        }\n        ."+i+" + div +  br {\n            display: none;\n        }\n        \n        ."+n+" {\n            margin-left: 0.2em;\n            cursor: pointer;\n        }\n        \n        ."+n+"::after {\n            content: '[✕]';\n        }\n        \n        .catthreadlist a {\n          position: relative;\n          transition: all .3s ease-in-out;\n        }\n        \n        .catthreadlist ."+a+" {\n          opacity: .6;\n        }\n        \n        .catthreadlist ."+a+":not(:hover) {\n          opacity: .2;\n          filter: blur(1px);\n        }\n        \n        .catthread:hover ."+n+" {\n          display: block;\n        }\n        \n        .catthread ."+n+" {\n          text-decoration: none;\n          position: absolute;\n          top: 0;\n          right: 0;\n          display: none;\n          width: 25px;\n          height: 25px;\n        }\n        \n        .catthreadlist ."+a+" ."+n+"::after {\n          content: '[+]';\n        }\n      </style>")},b=function(){if(!document.querySelector("#de-main")&&!document.querySelector("body.replypage")&&(m(),v(),"MutationObserver"in window)){var e=new MutationObserver(function(e){e.forEach(function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=e.addedNodes[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var d=a.value;if(!d.querySelectorAll)return;v(d)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}})});e.observe(document.body,{childList:!0,subtree:!0})}};document.body?b():document.addEventListener("DOMContentLoaded",b)}();