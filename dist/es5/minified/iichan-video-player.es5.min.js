"use strict";!function(){var e=["webm","mp4","ogv"],t=function(e){var t=JSON.parse(window.localStorage.getItem("iichan_video_settings")||"{}");if(t.hasOwnProperty("enableSound")||(t.enableSound=!1),e.target.classList.contains("iichan-mute-video-checkbox"))return setTimeout(function(){return e.target.checked=!e.target.checked},0),t.enableSound=e.target.checked,window.localStorage.setItem("iichan_video_settings",JSON.stringify(t)),void e.preventDefault();var n=e.currentTarget.parentNode;if("on"===e.currentTarget.videoMode)e.currentTarget.videoMode="off",n.removeChild(document.getElementById(e.currentTarget.videoplayerid)),e.currentTarget.innerHTML=e.currentTarget.thumbHTML;else{e.currentTarget.videoMode="on";var r=document.createElement("video");r.id="video"+(""+Math.random()).replace(/\D/g,""),r.poster=e.currentTarget.thumbSrc,r.src=e.currentTarget.href,r.autoplay=!0,r.controls=!0,r.loop=!0,r.muted=!t.enableSound,r.classList.add("iichan-video-player"),e.currentTarget.videoplayerid=r.id,n.insertBefore(r,e.currentTarget.nextSibling);var o=t.enableSound?"checked":"";e.currentTarget.innerHTML='\n    <div>\n      <input type="checkbox" '.concat(o,' class="').concat("iichan-mute-video-checkbox",'" title="').concat("Включить звук при открытии видео",'">\n      <div class="').concat("iichan-hide-video-btn",'" title="').concat("Свернуть видео",'">').concat("[Свернуть видео]","</div>\n    </div>\n    ")}e.preventDefault()},n=function(n){var r=(n||document).querySelectorAll(".thumb"),o=!0,i=!1,a=void 0;try{for(var c,d=r[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var u=c.value,l=u.parentNode;if(l){var v=l.href.split(".").pop();e.includes(v)&&(l.thumbSrc=u.src,l.thumbHTML=l.innerHTML,l.addEventListener("click",t))}}}catch(e){i=!0,a=e}finally{try{o||null==d.return||d.return()}finally{if(i)throw a}}},r=function(){document.querySelector("#de-main")||(document.head.insertAdjacentHTML("beforeend",'<style type="text/css">\n    .'.concat("iichan-video-player"," {\n      max-width: 100%;\n      height: auto;\n      box-sizing: border-box;\n      padding: 2px 20px;\n      margin: 0;\n    }\n    .").concat("iichan-hide-video-btn"," {\n      padding: 2px 20px;\n    }\n    .").concat("iichan-mute-video-checkbox"," {\n      float: right;\n    }\n  </style>")),n(),"MutationObserver"in window&&new MutationObserver(function(e){e.forEach(function(e){var t=!0,r=!1,o=void 0;try{for(var i,a=e.addedNodes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var c=i.value;if(!c.querySelectorAll)return;n(c)}}catch(e){r=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}})}).observe(document.body,{childList:!0,subtree:!0}))};document.body?r():document.addEventListener("DOMContentLoaded",r)}();