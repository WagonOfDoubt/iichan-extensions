(()=>{const t=["jpg","jpeg","gif","png"],e=t=>{if(!window.matchMedia("(min-width: 10cm)").matches)return;const e=t.currentTarget.querySelector(".thumb"),n=e.src==e.dataset.fullSrc;e.setAttribute("width",n?e.dataset.thumbWidth:e.dataset.fullWidth),e.setAttribute("height",n?e.dataset.thumbHeight:e.dataset.fullHeight),e.src=n?e.dataset.thumbSrc:e.dataset.fullSrc,t.preventDefault()},n=n=>{const i=(n||document).querySelectorAll(".thumb");for(const n of i){const i=n.parentNode;if(!i)continue;const d=i.href.split(".").pop();if(!t.includes(d))continue;n.dataset.thumbWidth=n.getAttribute("width"),n.dataset.thumbHeight=n.getAttribute("height"),n.dataset.thumbSrc=n.src,n.dataset.fullSrc=i.href;const a=i.parentNode;if(!a)continue;const r=a.querySelector(".filesize > em");if(!r)continue;const s=r.innerText.match(/(\d+)x(\d+)/);null!==s&&(n.dataset.fullWidth=s[1],n.dataset.fullHeight=s[2],i.addEventListener("click",e))}},i=()=>document.body.classList.contains("de-runned")||!!document.body.querySelector("#de-main"),d=()=>{if(!i()&&!(()=>JSON.parse(window.localStorage.getItem("iichan_settings")||"{}"))().disable_expand_images&&(document.head.insertAdjacentHTML("beforeend",'<style type="text/css">\n      @media only screen and (min-width: 10cm) {\n        a img.thumb {\n          margin: 0;\n          padding: 2px 20px;\n        }\n      \n        a img.thumb[src*="/src/"] {\n          height: auto;\n          max-width: calc(100% - 40px);\n        }\n      }\n    </style>'),n(),"MutationObserver"in window)){if(i())return;new MutationObserver(t=>{t.forEach(t=>{for(const e of t.addedNodes){if(!e.querySelectorAll)return;n(e)}})}).observe(document.body,{childList:!0,subtree:!0})}};document.body?d():document.addEventListener("DOMContentLoaded",d)})();