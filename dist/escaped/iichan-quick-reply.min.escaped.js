try{eval("(()=>{\"use strict\";const e=\"iichan-quick-reply-btn\",t=\"Быстрый ответ\",n=\"iichan-quick-reply-container\",o=\"iichan-quick-reply-show-form-btn\",c={key:\"mainpage\",dummy:\"\",url:\"/cgi-bin/captcha1.pl/b/\"},{quickReplyContainer,postformContainer}=(()=>{const e=document.createElement(\"table\");e.insertAdjacentHTML(\"beforeend\",`\n          <tr>\n          \\t<td class=\"doubledash\">&gt;&gt;</td>\n          \\t<td class=\"iichan-postform-container reply\"></td>\n          </tr>\n          \n        `),e.id=n;const t=e.querySelector(\".iichan-postform-container\");return{quickReplyContainer:e,postformContainer:t}})(),r=(()=>{const e=document.createElement(\"a\");return e.classList.add(o),e})(),i=(()=>{const e=document.createElement(\"input\");return e.setAttribute(\"type\",\"hidden\"),e.setAttribute(\"name\",\"parent\"),e})(),d=()=>{const e=document.querySelector(\"#captcha\");if(e){const{url,key,dummy}=c;e.src=`${url}?key=${key}&dummy=${dummy}&${Math.random()}`}},a=e=>{if(e){const t=e.id.substr(\"thread-\".length),n=e.querySelector(\"table:last-child .reply\"),o=n?n.id.substr(\"reply\".length):t;c.key=`res${t}`,c.dummy=o}else c.key=\"mainpage\",c.dummy=\"\";d()},u=(e,t)=>{let n=e.querySelector(\"[name=parent]\");return t?(n||(n=i,e.appendChild(n)),void n.setAttribute(\"value\",t)):void(n&&e.removeChild(n))},s=(e,t)=>{let n=e;for(;n&&n!==document&&!n.matches(t);)n=n.parentNode;return n===document?null:n},l=e=>{const t=document.querySelector(\"[name=nya4]\");t&&(t.focus(!1),e&&(e=`>>${e}\n`,t.value.endsWith(e)||(t.value.length&&!t.value.endsWith(\"\\n\")&&(e=\"\\n\"+e),t.setRangeText(e,t.textLength,t.textLength,\"end\"))))},p=()=>{const e=document.querySelector(\".postarea\");e&&e.appendChild(r)},m=(e,t)=>{const n=s(t,\"table\"),o=s(t,\"[id^=thread]\");if(n&&o){const c=o.id.substr(\"thread-\".length),r=t.id.substr(\"reply\".length);postformContainer.appendChild(e),n.parentNode.insertBefore(quickReplyContainer,n.nextSibling),p(),u(e,c),a(o),l(r)}},f=(e,t)=>{const n=t.querySelector(\"table\"),o=t.id.substr(\"thread-\".length);postformContainer.appendChild(e),t.insertBefore(quickReplyContainer,n),p(),u(e,o),a(t),l(o)},y=(e,t)=>{const n=document.querySelector(\".postarea\");if(n&&(n.appendChild(e),t&&l()),quickReplyContainer.parentNode&&quickReplyContainer.parentNode.removeChild(quickReplyContainer),r.parentNode&&r.parentNode.removeChild(r),document.body.classList.contains(\"replypage\")){const t=document.querySelector(\"[id^=thread]\"),n=t.id.substr(\"thread-\".length);u(e,n),a(t)}else u(e,null),a()},h=e=>{const t=document.querySelector(\"#postform\");t&&(e?t.dataset.replyTo===e.id?(t.dataset.replyTo=\"\",y(t,!1)):e.classList.contains(\"reply\")?(t.dataset.replyTo=e.id,m(t,e)):(t.dataset.replyTo=e.id,f(t,e)):(t.dataset.replyTo=\"\",y(t,!0)))},b=e=>{const t=e.target,n=document.querySelector(t.dataset.postId);h(n)},q=n=>{if(n){const o=n.querySelector(\":scope > .reflink\");if(o){const c=document.createElement(\"span\");c.title=t,c.classList.add(e),c.dataset.postId=\"#\"+n.id,c.addEventListener(\"click\",b),n.insertBefore(c,o.nextSibling)}}},S=e=>{const t=(e||document).querySelectorAll(\".reply, [id^=thread]\");for(const n of t)q(n)},g=()=>{document.head.insertAdjacentHTML(\"beforeend\",`<style type=\"text/css\">\n        .iichan-quick-reply-btn::after {\n          content: '[▶]';\n        }\n        \n        .replypage .iichan-quick-reply-show-form-btn::after {\n          content: '[Показать форму ответа]';\n        }\n        \n        .iichan-quick-reply-show-form-btn::after {\n          content: '[Создать тред]';\n        }\n        \n        .iichan-quick-reply-show-form-btn,\n        .iichan-quick-reply-btn {\n          cursor: pointer;\n        }\n        \n        #${n} .rules {\n          display: none;\n        }\n        \n      </style>`)},v=()=>{if(!document.querySelector(\"#de-main\")){const e=document.querySelector(\"#captcha\");e&&(c.url=e.getAttribute(\"src\").match(/[^\\?]*/)[0]);const t=document.querySelector(\"input[name=captcha] + a\");if(t&&(t.removeAttribute(\"onclick\"),t.addEventListener(\"click\",e=>{d(),e.preventDefault()})),document.body.classList.contains(\"replypage\")){const e=document.querySelector(\"[id^=thread]\");a(e)}else a();if(g(),S(),r.addEventListener(\"click\",e=>{h(),e.preventDefault()}),\"MutationObserver\"in window){const e=new MutationObserver(e=>{e.forEach(e=>{for(const t of e.addedNodes){if(!t.querySelectorAll)return;S(t)}})});e.observe(document.body,{childList:!0,subtree:!0})}}};document.body?v():document.addEventListener(\"DOMContentLoaded\",v)})();");}catch(e){}